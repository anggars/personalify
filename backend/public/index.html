<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Personalify Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>ðŸŽ§ Personalify</h1>
    <p>Top Spotify Summary</p>
  </header>

  <section>
    <div class="input-group">
      <input type="text" id="spotifyIdInput" placeholder="Enter Spotify ID" />
      <select id="timeRange">
        <option value="short_term">Last Month</option>
        <option value="medium_term" selected>Last 6 Months</option>
        <option value="long_term">All Time</option>
      </select>
      <button onclick="fetchData()">Get My Data</button>
    </div>
  </section>

  <section class="data-section">
    <h2>ðŸŽ¤ Top Artists</h2>
    <ul id="artistsList"></ul>

    <h2>ðŸŽµ Top Tracks</h2>
    <ul id="tracksList"></ul>

    <h2>ðŸ“Š Top Genres</h2>
    <ul id="genresList"></ul>
  </section>

  <script>
    async function fetchData() {
      const id = document.getElementById("spotifyIdInput").value;
      const timeRange = document.getElementById("timeRange").value;
      if (!id) return alert("Please enter Spotify ID");

      // Fetch Top Data
      const res = await fetch(`http://localhost:8000/top-data?spotify_id=${id}&time_range=${timeRange}`);
      const data = await res.json();

      const artistsList = document.getElementById("artistsList");
      const tracksList = document.getElementById("tracksList");
      artistsList.innerHTML = "";
      tracksList.innerHTML = "";

      data.artists.forEach(artist => {
        artistsList.innerHTML += `<li><img src="${artist.image}" width="30"> ${artist.name}</li>`;
      });

      data.tracks.forEach(track => {
        tracksList.innerHTML += `<li>${track.name} â€” ${track.artists.join(", ")}</li>`;
      });

      // Fetch Genres
      const genresRes = await fetch(`http://localhost:8000/top-genres?spotify_id=${id}&time_range=${timeRange}`);
      const genresData = await genresRes.json();
      const genresList = document.getElementById("genresList");
      genresList.innerHTML = "";

      genresData.genres.forEach(genre => {
        genresList.innerHTML += `<li>${genre.name} (${genre.count})</li>`;
      });
    }
  </script>
</body>
</html>
